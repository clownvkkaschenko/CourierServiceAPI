---
openapi: 3.1.0
info:
  title: Courier Service API
  description: Прототип API сервиса курьерской доставки.
  version: 0.1.0
paths:
  "/api/v1/users":
    post:
      tags:
      - Авторизация
      summary: Регистрация пользователя
      description: Регистрация пользователя.
      operationId: register_user_api_v1_users_post
      requestBody:
        content:
          application/json:
            schema:
              "$ref": "#/components/schemas/CreateUserPyd"
        required: true
      responses:
        '200':
          description: Successful Response
          content:
            application/json:
              schema:
                "$ref": "#/components/schemas/ResponseUserPyd"
        '422':
          description: Validation Error
          content:
            application/json:
              schema:
                "$ref": "#/components/schemas/HTTPValidationError"
  "/api/v1/token":
    post:
      tags:
      - Авторизация
      summary: Получение токена
      description: Получение токена.
      operationId: login_for_access_token_api_v1_token_post
      requestBody:
        content:
          application/json:
            schema:
              "$ref": "#/components/schemas/CreateTokenPyd"
        required: true
      responses:
        '200':
          description: Successful Response
          content:
            application/json:
              schema:
                "$ref": "#/components/schemas/ResponseTokenPyd"
        '422':
          description: Validation Error
          content:
            application/json:
              schema:
                "$ref": "#/components/schemas/HTTPValidationError"
  "/api/v1/users/orders":
    get:
      tags:
      - Пользователи
      summary: Все заказы пользователя
      description: Все заказы пользователя.
      operationId: get_all_user_orders_api_v1_users_orders_get
      responses:
        '200':
          description: Successful Response
          content:
            application/json:
              schema:
                items:
                  "$ref": "#/components/schemas/BaseOrderPyd"
                type: array
                title: Response Get All User Orders Api V1 Users Orders Get
      security:
      - OAuth2PasswordBearer: []
  "/api/v1/shipping_cost/{restaurant_id}":
    get:
      tags:
      - Пользователи
      summary: Расчёт стоимости доставки
      description: Расчёт стоимости доставки из выбранного ресторана.
      operationId: shipping_cost_api_v1_shipping_cost__restaurant_id__get
      security:
      - OAuth2PasswordBearer: []
      parameters:
      - name: restaurant_id
        in: path
        required: true
        schema:
          type: integer
          description: ID ресторана
          title: Restaurant Id
        description: ID ресторана
      responses:
        '200':
          description: Successful Response
          content:
            application/json:
              schema:
                "$ref": "#/components/schemas/ShippingCostPyd"
        '422':
          description: Validation Error
          content:
            application/json:
              schema:
                "$ref": "#/components/schemas/HTTPValidationError"
  "/api/v1/users/orders/{restaurant_id}":
    post:
      tags:
      - Пользователи
      summary: Сделать заказ из ресторана
      description: Сделать заказ из ресторана.
      operationId: new_order_api_v1_users_orders__restaurant_id__post
      security:
      - OAuth2PasswordBearer: []
      parameters:
      - name: restaurant_id
        in: path
        required: true
        schema:
          type: integer
          description: ID ресторана
          title: Restaurant Id
        description: ID ресторана
      responses:
        '200':
          description: Successful Response
          content:
            application/json:
              schema:
                "$ref": "#/components/schemas/ResponseUserCreateOrderPyd"
        '422':
          description: Validation Error
          content:
            application/json:
              schema:
                "$ref": "#/components/schemas/HTTPValidationError"
  "/api/v1/users/active_orders":
    get:
      tags:
      - Пользователи
      summary: Активные заказы пользователя
      description: |-
        Информация об активных заказах пользователя. Статус заказа
        находится в состоянии «Поиск курьера» или «В пути».
      operationId: active_orders_api_v1_users_active_orders_get
      responses:
        '200':
          description: Successful Response
          content:
            application/json:
              schema:
                items:
                  "$ref": "#/components/schemas/BaseOrderPyd"
                type: array
                title: Response Active Orders Api V1 Users Active Orders Get
      security:
      - OAuth2PasswordBearer: []
  "/api/v1/restaurants":
    post:
      tags:
      - Рестораны
      summary: Добавить ресторан
      description: Добавить ресторан.
      operationId: create_restaurant_api_v1_restaurants_post
      requestBody:
        content:
          application/json:
            schema:
              "$ref": "#/components/schemas/CreateRestaurantPyd"
        required: true
      responses:
        '200':
          description: Successful Response
          content:
            application/json:
              schema:
                "$ref": "#/components/schemas/ResponseRestaurantPyd"
        '422':
          description: Validation Error
          content:
            application/json:
              schema:
                "$ref": "#/components/schemas/HTTPValidationError"
      security:
      - OAuth2PasswordBearer: []
  "/api/v1/restaurants/{restaurant_id}/orders":
    get:
      tags:
      - Рестораны
      summary: Все заказы из выбранного ресторана
      description: Все заказы ресторана.
      operationId: get_all_restaurant_orders_api_v1_restaurants__restaurant_id__orders_get
      security:
      - OAuth2PasswordBearer: []
      parameters:
      - name: restaurant_id
        in: path
        required: true
        schema:
          type: integer
          description: ID ресторана
          title: Restaurant Id
        description: ID ресторана
      responses:
        '200':
          description: Successful Response
          content:
            application/json:
              schema:
                type: array
                items:
                  "$ref": "#/components/schemas/SummaryRestaurantOrderPyd"
                title: Response Get All Restaurant Orders Api V1 Restaurants  Restaurant
                  Id  Orders Get
        '422':
          description: Validation Error
          content:
            application/json:
              schema:
                "$ref": "#/components/schemas/HTTPValidationError"
  "/api/v1/restaurants/{restaurant_id}/orders/{order_id}":
    get:
      tags:
      - Рестораны
      summary: Подробная информация об одном выбранном заказе
      description: Подробная информация о выбранном заказе.
      operationId: get_restaurant_order_api_v1_restaurants__restaurant_id__orders__order_id__get
      security:
      - OAuth2PasswordBearer: []
      parameters:
      - name: restaurant_id
        in: path
        required: true
        schema:
          type: integer
          description: ID ресторана
          title: Restaurant Id
        description: ID ресторана
      - name: order_id
        in: path
        required: true
        schema:
          type: integer
          description: ID заказа
          title: Order Id
        description: ID заказа
      responses:
        '200':
          description: Successful Response
          content:
            application/json:
              schema:
                "$ref": "#/components/schemas/DetailedRestaurantOrderPyd"
        '422':
          description: Validation Error
          content:
            application/json:
              schema:
                "$ref": "#/components/schemas/HTTPValidationError"
components:
  schemas:
    BaseOrderPyd:
      properties:
        id:
          type: integer
          title: Id
          description: ID объекта в БД
        status:
          type: string
          title: Status
          description: Статус заказа
        start_time:
          type: string
          format: date-time
          title: Start Time
          description: Время создания заказа
        restaurant_id:
          type: integer
          title: Restaurant Id
          description: ID ресторана, из которого сделан заказ
      type: object
      required:
      - id
      - status
      - start_time
      - restaurant_id
      title: BaseOrderPyd
      description: |-
        Pydantic модель с базовыми полями для информации о заказе.

        Fields:
            - id: int
            - status: int
            - start_time: datetime
            - restaurant_id: int
    CreateRestaurantPyd:
      properties:
        city:
          anyOf:
          - type: string
          - type: 'null'
          title: City
          description: Город
          default: Тюмень
        street:
          type: string
          title: Street
          description: Улица
        house_number:
          type: string
          title: House Number
          description: Номер дома
        name:
          type: string
          title: Name
          description: Название ресторана
        opening_time:
          type: string
          format: time
          title: Opening Time
          description: Время открытия ресторана
        closing_time:
          type: string
          format: time
          title: Closing Time
          description: Время закрытия ресторана
        duration_delivery:
          type: integer
          title: Duration Delivery
          description: Примерное время доставки заказа/в минутах
      type: object
      required:
      - street
      - house_number
      - name
      - opening_time
      - closing_time
      - duration_delivery
      title: CreateRestaurantPyd
      description: |-
        Pydantic модель для создания ресторана.

        Fields:
            - name: str
            - opening_time: time
            - closing_time: time
            - duration_delivery: int
            - city: Optional[str]
            - street: str
            - house_number: str
    CreateTokenPyd:
      properties:
        phone_number:
          type: string
          title: Phone Number
          description: Телефон пользователя
        password:
          type: string
          title: Password
          description: Пароль пользователя
      type: object
      required:
      - phone_number
      - password
      title: CreateTokenPyd
      description: Pydantic модель для создания токена.
    CreateUserPyd:
      properties:
        city:
          anyOf:
          - type: string
          - type: 'null'
          title: City
          description: Город
          default: Тюмень
        street:
          type: string
          title: Street
          description: Улица
        house_number:
          type: string
          title: House Number
          description: Номер дома
        phone_number:
          type: string
          title: Phone Number
          description: Телефон пользователя
        name:
          type: string
          title: Name
          description: Имя пользователя
        surname:
          type: string
          title: Surname
          description: Фамилия пользователя
        password:
          type: string
          title: Password
          description: Пароль пользователя
      type: object
      required:
      - street
      - house_number
      - phone_number
      - name
      - surname
      - password
      title: CreateUserPyd
      description: |-
        Pydantic модель для регистрации пользователя.

        Fields:
            - city: Optional[str]
            - street: str
            - house_number: str
            - phone_number: str
            - name: str
            - surname: str
            - password: str
    DetailedRestaurantOrderPyd:
      properties:
        id:
          type: integer
          title: Id
          description: ID объекта в БД
        status:
          type: string
          title: Status
          description: Статус заказа
        start_time:
          type: string
          format: date-time
          title: Start Time
          description: Время создания заказа
        restaurant_id:
          type: integer
          title: Restaurant Id
          description: ID ресторана, из которого сделан заказ
        end_time:
          anyOf:
          - type: string
            format: date-time
          - type: 'null'
          title: End Time
          description: Время завершения доставки
        courier:
          anyOf:
          - "$ref": "#/components/schemas/ResponseUserPyd"
          - type: 'null'
          description: Курьер
        user:
          allOf:
          - "$ref": "#/components/schemas/DetailedUserInfoPyd"
          description: Пользователь который сделал заказ
      type: object
      required:
      - id
      - status
      - start_time
      - restaurant_id
      - user
      title: DetailedRestaurantOrderPyd
      description: |-
        Pydantic модель с подробной информацией о заказе ресторана.

        Fields:
            - id: int
            - status: int
            - start_time: datetime
            - restaurant_id: int
            - end_time: Optional[datetime]
            - courier: Optional[ResponseUserPyd]
            - user: DetailedUserInfoPyd
    DetailedUserInfoPyd:
      properties:
        city:
          anyOf:
          - type: string
          - type: 'null'
          title: City
          description: Город
          default: Тюмень
        street:
          type: string
          title: Street
          description: Улица
        house_number:
          type: string
          title: House Number
          description: Номер дома
        phone_number:
          type: string
          title: Phone Number
          description: Телефон пользователя
        name:
          type: string
          title: Name
          description: Имя пользователя
        surname:
          type: string
          title: Surname
          description: Фамилия пользователя
        id:
          type: integer
          title: Id
          description: ID объекта в БД
      type: object
      required:
      - street
      - house_number
      - phone_number
      - name
      - surname
      - id
      title: DetailedUserInfoPyd
      description: |-
        Pydantic модель для вывода  подробной информации о пользователе.

        Fields:
            - id: int
            - city: Optional[str]
            - street: str
            - house_number: str
            - phone_number: str
            - name: str
            - surname: str
    HTTPValidationError:
      properties:
        detail:
          items:
            "$ref": "#/components/schemas/ValidationError"
          type: array
          title: Detail
      type: object
      title: HTTPValidationError
    ResponseRestaurantPyd:
      properties:
        id:
          type: integer
          title: Id
          description: ID объекта в БД
        name:
          type: string
          title: Name
          description: Название ресторана
      type: object
      required:
      - id
      - name
      title: ResponseRestaurantPyd
      description: |-
        Pydantic модель для вывода информации о ресторане, после его создания.

        Fields:
            - id: int
            - name: int
    ResponseTokenPyd:
      properties:
        access_token:
          type: string
          title: Access Token
          description: Токен
        token_type:
          type: string
          title: Token Type
          description: Тип токена
      type: object
      required:
      - access_token
      - token_type
      title: ResponseTokenPyd
      description: Pydantic модель для вывода токена.
    ResponseUserCreateOrderPyd:
      properties:
        shipping_cost:
          type: integer
          title: Shipping Cost
          description: Стоимость доставки из ресторана
        id:
          type: integer
          title: Id
          description: ID объекта в БД
        status:
          type: string
          title: Status
          description: Статус заказа
        start_time:
          type: string
          format: date-time
          title: Start Time
          description: Время создания заказа
        restaurant_id:
          type: integer
          title: Restaurant Id
          description: ID ресторана, из которого сделан заказ
      type: object
      required:
      - shipping_cost
      - id
      - status
      - start_time
      - restaurant_id
      title: ResponseUserCreateOrderPyd
      description: |-
        Pydantic модель для вывода информации о заказе, после его создания.

        Fields:
            - id: int
            - status: int
            - start_time: datetime
            - restaurant_id: int
            - shipping_cost: int
    ResponseUserPyd:
      properties:
        phone_number:
          type: string
          title: Phone Number
          description: Телефон пользователя
        name:
          type: string
          title: Name
          description: Имя пользователя
        surname:
          type: string
          title: Surname
          description: Фамилия пользователя
        id:
          type: integer
          title: Id
          description: ID объекта в БД
      type: object
      required:
      - phone_number
      - name
      - surname
      - id
      title: ResponseUserPyd
      description: |-
        Pydantic модель для вывода информации о пользователе.

        Fields:
            - id: int
            - phone_number: str
            - name: str
            - surname: str
    ShippingCostPyd:
      properties:
        shipping_cost:
          type: integer
          title: Shipping Cost
          description: Стоимость доставки из ресторана
      type: object
      required:
      - shipping_cost
      title: ShippingCostPyd
      description: |-
        Pydantic модель для расчёта стоимости доставки.

        Fields:
            - shipping_cost: int
    SummaryRestaurantOrderPyd:
      properties:
        id:
          type: integer
          title: Id
          description: ID объекта в БД
        status:
          type: string
          title: Status
          description: Статус заказа
        start_time:
          type: string
          format: date-time
          title: Start Time
          description: Время создания заказа
        restaurant_id:
          type: integer
          title: Restaurant Id
          description: ID ресторана, из которого сделан заказ
        courier_id:
          anyOf:
          - type: integer
          - type: 'null'
          title: Courier Id
          description: ID курьера
        user_id:
          type: integer
          title: User Id
          description: ID пользователя, который сделал заказ
      type: object
      required:
      - id
      - status
      - start_time
      - restaurant_id
      - user_id
      title: SummaryRestaurantOrderPyd
      description: |-
        Pydantic модель с краткой информацией о заказах ресторана.

        Fields:
            - id: int
            - status: int
            - start_time: datetime
            - restaurant_id: int
            - courier_id: Optional[int]
            - user_id: int
    ValidationError:
      properties:
        loc:
          items:
            anyOf:
            - type: string
            - type: integer
          type: array
          title: Location
        msg:
          type: string
          title: Message
        type:
          type: string
          title: Error Type
      type: object
      required:
      - loc
      - msg
      - type
      title: ValidationError
  securitySchemes:
    OAuth2PasswordBearer:
      type: oauth2
      flows:
        password:
          scopes: {}
          tokenUrl: token
